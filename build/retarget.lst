ARM GAS  /tmp/cccbhmYm.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"retarget.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.global	__stdout
  18              		.section	.bss.__stdout,"aw",%nobits
  19              		.align	2
  22              	__stdout:
  23 0000 00000000 		.space	104
  23      00000000 
  23      00000000 
  23      00000000 
  23      00000000 
  24              		.global	__stdin
  25              		.section	.bss.__stdin,"aw",%nobits
  26              		.align	2
  29              	__stdin:
  30 0000 00000000 		.space	104
  30      00000000 
  30      00000000 
  30      00000000 
  30      00000000 
  31              		.section	.rodata
  32              		.align	2
  33              	.LC0:
  34 0000 72302020 		.ascii	"r0  = 0x%lx\012\000"
  34      3D203078 
  34      256C780A 
  34      00
  35 000d 000000   		.align	2
  36              	.LC1:
  37 0010 72312020 		.ascii	"r1  = 0x%lx\012\000"
  37      3D203078 
  37      256C780A 
  37      00
  38 001d 000000   		.align	2
  39              	.LC2:
  40 0020 72322020 		.ascii	"r2  = 0x%lx\012\000"
  40      3D203078 
  40      256C780A 
  40      00
  41 002d 000000   		.align	2
  42              	.LC3:
  43 0030 72332020 		.ascii	"r3  = 0x%lx\012\000"
  43      3D203078 
ARM GAS  /tmp/cccbhmYm.s 			page 2


  43      256C780A 
  43      00
  44 003d 000000   		.align	2
  45              	.LC4:
  46 0040 72313220 		.ascii	"r12 = 0x%lx\012\000"
  46      3D203078 
  46      256C780A 
  46      00
  47 004d 000000   		.align	2
  48              	.LC5:
  49 0050 6C722020 		.ascii	"lr  = 0x%lx\012\000"
  49      3D203078 
  49      256C780A 
  49      00
  50 005d 000000   		.align	2
  51              	.LC6:
  52 0060 70632020 		.ascii	"pc  = 0x%lx\012\000"
  52      3D203078 
  52      256C780A 
  52      00
  53 006d 000000   		.align	2
  54              	.LC7:
  55 0070 70737220 		.ascii	"psr = 0x%lx\012\000"
  55      3D203078 
  55      256C780A 
  55      00
  56              		.section	.text.stackDump,"ax",%progbits
  57              		.align	1
  58              		.arch armv7e-m
  59              		.syntax unified
  60              		.thumb
  61              		.thumb_func
  62              		.fpu fpv4-sp-d16
  64              	stackDump:
  65              	.LFB195:
  66              		.file 1 "Drivers/Library/StdDriver/src/retarget.c"
   1:Drivers/Library/StdDriver/src/retarget.c **** /**************************************************************************//**
   2:Drivers/Library/StdDriver/src/retarget.c ****  * @file     retarget.c
   3:Drivers/Library/StdDriver/src/retarget.c ****  * @version  V3.00
   4:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    M480 Series Debug Port and Semihost Setting Source File
   5:Drivers/Library/StdDriver/src/retarget.c ****  *
   6:Drivers/Library/StdDriver/src/retarget.c ****  * SPDX-License-Identifier: Apache-2.0
   7:Drivers/Library/StdDriver/src/retarget.c ****  * @copyright (C) 2016-2020 Nuvoton Technology Corp. All rights reserved.
   8:Drivers/Library/StdDriver/src/retarget.c ****  ******************************************************************************/
   9:Drivers/Library/StdDriver/src/retarget.c **** 
  10:Drivers/Library/StdDriver/src/retarget.c **** 
  11:Drivers/Library/StdDriver/src/retarget.c **** #include <stdio.h>
  12:Drivers/Library/StdDriver/src/retarget.c **** #include "NuMicro.h"
  13:Drivers/Library/StdDriver/src/retarget.c **** 
  14:Drivers/Library/StdDriver/src/retarget.c **** #if defined ( __CC_ARM   )
  15:Drivers/Library/StdDriver/src/retarget.c **** #if (__ARMCC_VERSION < 400000)
  16:Drivers/Library/StdDriver/src/retarget.c **** #else
  17:Drivers/Library/StdDriver/src/retarget.c **** /* Insist on keeping widthprec, to avoid X propagation by benign code in C-lib */
  18:Drivers/Library/StdDriver/src/retarget.c **** #pragma import _printf_widthprec
  19:Drivers/Library/StdDriver/src/retarget.c **** #endif
  20:Drivers/Library/StdDriver/src/retarget.c **** #endif
  21:Drivers/Library/StdDriver/src/retarget.c **** /* Uncomment this line to disable all printf and getchar. getchar() will always return 0x00*/
ARM GAS  /tmp/cccbhmYm.s 			page 3


  22:Drivers/Library/StdDriver/src/retarget.c **** /* #define DISABLE_UART */
  23:Drivers/Library/StdDriver/src/retarget.c **** 
  24:Drivers/Library/StdDriver/src/retarget.c **** #if defined(DEBUG_ENABLE_SEMIHOST)
  25:Drivers/Library/StdDriver/src/retarget.c ****     #ifndef DISABLE_UART
  26:Drivers/Library/StdDriver/src/retarget.c ****         #define DISABLE_UART
  27:Drivers/Library/StdDriver/src/retarget.c ****     #endif
  28:Drivers/Library/StdDriver/src/retarget.c **** #endif
  29:Drivers/Library/StdDriver/src/retarget.c **** 
  30:Drivers/Library/StdDriver/src/retarget.c **** #define DEBUG_PORT   UART0
  31:Drivers/Library/StdDriver/src/retarget.c **** /*-------------------------------------------------------------------------------------------------
  32:Drivers/Library/StdDriver/src/retarget.c **** /* Global variables                                                                                
  33:Drivers/Library/StdDriver/src/retarget.c **** /*-------------------------------------------------------------------------------------------------
  34:Drivers/Library/StdDriver/src/retarget.c **** #if !(defined(__ICCARM__) && (__VER__ >= 6010000))
  35:Drivers/Library/StdDriver/src/retarget.c **** # if (__ARMCC_VERSION < 6040000)
  36:Drivers/Library/StdDriver/src/retarget.c **** struct __FILE
  37:Drivers/Library/StdDriver/src/retarget.c **** {
  38:Drivers/Library/StdDriver/src/retarget.c ****     int handle; /* Add whatever you need here */
  39:Drivers/Library/StdDriver/src/retarget.c **** };
  40:Drivers/Library/StdDriver/src/retarget.c **** # endif
  41:Drivers/Library/StdDriver/src/retarget.c **** #elif(__VER__ >= 8000000)
  42:Drivers/Library/StdDriver/src/retarget.c **** struct __FILE
  43:Drivers/Library/StdDriver/src/retarget.c **** {
  44:Drivers/Library/StdDriver/src/retarget.c ****     int handle; /* Add whatever you need here */
  45:Drivers/Library/StdDriver/src/retarget.c **** };
  46:Drivers/Library/StdDriver/src/retarget.c **** #endif
  47:Drivers/Library/StdDriver/src/retarget.c **** FILE __stdout;
  48:Drivers/Library/StdDriver/src/retarget.c **** FILE __stdin;
  49:Drivers/Library/StdDriver/src/retarget.c **** 
  50:Drivers/Library/StdDriver/src/retarget.c **** 
  51:Drivers/Library/StdDriver/src/retarget.c **** enum { r0, r1, r2, r3, r12, lr, pc, psr};
  52:Drivers/Library/StdDriver/src/retarget.c **** 
  53:Drivers/Library/StdDriver/src/retarget.c **** /**
  54:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Helper function to dump register while hard fault occurred
  55:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]   stack pointer points to the dumped registers in SRAM
  56:Drivers/Library/StdDriver/src/retarget.c ****  * @return      None
  57:Drivers/Library/StdDriver/src/retarget.c ****  * @details     This function is implement to print r0, r1, r2, r3, r12, lr, pc, psr
  58:Drivers/Library/StdDriver/src/retarget.c ****  */
  59:Drivers/Library/StdDriver/src/retarget.c **** static void stackDump(uint32_t stack[])
  60:Drivers/Library/StdDriver/src/retarget.c **** {
  67              		.loc 1 60 1
  68              		.cfi_startproc
  69              		@ args = 0, pretend = 0, frame = 8
  70              		@ frame_needed = 1, uses_anonymous_args = 0
  71 0000 80B5     		push	{r7, lr}
  72              	.LCFI0:
  73              		.cfi_def_cfa_offset 8
  74              		.cfi_offset 7, -8
  75              		.cfi_offset 14, -4
  76 0002 82B0     		sub	sp, sp, #8
  77              	.LCFI1:
  78              		.cfi_def_cfa_offset 16
  79 0004 00AF     		add	r7, sp, #0
  80              	.LCFI2:
  81              		.cfi_def_cfa_register 7
  82 0006 7860     		str	r0, [r7, #4]
  61:Drivers/Library/StdDriver/src/retarget.c ****     printf("r0  = 0x%lx\n", stack[r0]);
  83              		.loc 1 61 5
ARM GAS  /tmp/cccbhmYm.s 			page 4


  84 0008 7B68     		ldr	r3, [r7, #4]
  85 000a 1B68     		ldr	r3, [r3]
  86 000c 1946     		mov	r1, r3
  87 000e 1C48     		ldr	r0, .L2
  88 0010 FFF7FEFF 		bl	printf
  62:Drivers/Library/StdDriver/src/retarget.c ****     printf("r1  = 0x%lx\n", stack[r1]);
  89              		.loc 1 62 34
  90 0014 7B68     		ldr	r3, [r7, #4]
  91 0016 0433     		adds	r3, r3, #4
  92              		.loc 1 62 5
  93 0018 1B68     		ldr	r3, [r3]
  94 001a 1946     		mov	r1, r3
  95 001c 1948     		ldr	r0, .L2+4
  96 001e FFF7FEFF 		bl	printf
  63:Drivers/Library/StdDriver/src/retarget.c ****     printf("r2  = 0x%lx\n", stack[r2]);
  97              		.loc 1 63 34
  98 0022 7B68     		ldr	r3, [r7, #4]
  99 0024 0833     		adds	r3, r3, #8
 100              		.loc 1 63 5
 101 0026 1B68     		ldr	r3, [r3]
 102 0028 1946     		mov	r1, r3
 103 002a 1748     		ldr	r0, .L2+8
 104 002c FFF7FEFF 		bl	printf
  64:Drivers/Library/StdDriver/src/retarget.c ****     printf("r3  = 0x%lx\n", stack[r3]);
 105              		.loc 1 64 34
 106 0030 7B68     		ldr	r3, [r7, #4]
 107 0032 0C33     		adds	r3, r3, #12
 108              		.loc 1 64 5
 109 0034 1B68     		ldr	r3, [r3]
 110 0036 1946     		mov	r1, r3
 111 0038 1448     		ldr	r0, .L2+12
 112 003a FFF7FEFF 		bl	printf
  65:Drivers/Library/StdDriver/src/retarget.c ****     printf("r12 = 0x%lx\n", stack[r12]);
 113              		.loc 1 65 34
 114 003e 7B68     		ldr	r3, [r7, #4]
 115 0040 1033     		adds	r3, r3, #16
 116              		.loc 1 65 5
 117 0042 1B68     		ldr	r3, [r3]
 118 0044 1946     		mov	r1, r3
 119 0046 1248     		ldr	r0, .L2+16
 120 0048 FFF7FEFF 		bl	printf
  66:Drivers/Library/StdDriver/src/retarget.c ****     printf("lr  = 0x%lx\n", stack[lr]);
 121              		.loc 1 66 34
 122 004c 7B68     		ldr	r3, [r7, #4]
 123 004e 1433     		adds	r3, r3, #20
 124              		.loc 1 66 5
 125 0050 1B68     		ldr	r3, [r3]
 126 0052 1946     		mov	r1, r3
 127 0054 0F48     		ldr	r0, .L2+20
 128 0056 FFF7FEFF 		bl	printf
  67:Drivers/Library/StdDriver/src/retarget.c ****     printf("pc  = 0x%lx\n", stack[pc]);
 129              		.loc 1 67 34
 130 005a 7B68     		ldr	r3, [r7, #4]
 131 005c 1833     		adds	r3, r3, #24
 132              		.loc 1 67 5
 133 005e 1B68     		ldr	r3, [r3]
 134 0060 1946     		mov	r1, r3
ARM GAS  /tmp/cccbhmYm.s 			page 5


 135 0062 0D48     		ldr	r0, .L2+24
 136 0064 FFF7FEFF 		bl	printf
  68:Drivers/Library/StdDriver/src/retarget.c ****     printf("psr = 0x%lx\n", stack[psr]);
 137              		.loc 1 68 34
 138 0068 7B68     		ldr	r3, [r7, #4]
 139 006a 1C33     		adds	r3, r3, #28
 140              		.loc 1 68 5
 141 006c 1B68     		ldr	r3, [r3]
 142 006e 1946     		mov	r1, r3
 143 0070 0A48     		ldr	r0, .L2+28
 144 0072 FFF7FEFF 		bl	printf
  69:Drivers/Library/StdDriver/src/retarget.c **** }
 145              		.loc 1 69 1
 146 0076 00BF     		nop
 147 0078 0837     		adds	r7, r7, #8
 148              	.LCFI3:
 149              		.cfi_def_cfa_offset 8
 150 007a BD46     		mov	sp, r7
 151              	.LCFI4:
 152              		.cfi_def_cfa_register 13
 153              		@ sp needed
 154 007c 80BD     		pop	{r7, pc}
 155              	.L3:
 156 007e 00BF     		.align	2
 157              	.L2:
 158 0080 00000000 		.word	.LC0
 159 0084 10000000 		.word	.LC1
 160 0088 20000000 		.word	.LC2
 161 008c 30000000 		.word	.LC3
 162 0090 40000000 		.word	.LC4
 163 0094 50000000 		.word	.LC5
 164 0098 60000000 		.word	.LC6
 165 009c 70000000 		.word	.LC7
 166              		.cfi_endproc
 167              	.LFE195:
 169              		.section	.rodata
 170 007d 000000   		.align	2
 171              	.LC8:
 172 0080 496E2048 		.ascii	"In Hard Fault Handler\000"
 172      61726420 
 172      4661756C 
 172      74204861 
 172      6E646C65 
 173              		.section	.text.Hard_Fault_Handler,"ax",%progbits
 174              		.align	1
 175              		.global	Hard_Fault_Handler
 176              		.syntax unified
 177              		.thumb
 178              		.thumb_func
 179              		.fpu fpv4-sp-d16
 181              	Hard_Fault_Handler:
 182              	.LFB196:
  70:Drivers/Library/StdDriver/src/retarget.c **** 
  71:Drivers/Library/StdDriver/src/retarget.c **** /**
  72:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Hard fault handler
  73:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]   stack pointer points to the dumped registers in SRAM
  74:Drivers/Library/StdDriver/src/retarget.c ****  * @return      None
ARM GAS  /tmp/cccbhmYm.s 			page 6


  75:Drivers/Library/StdDriver/src/retarget.c ****  * @details     Replace while(1) at the end of this function with chip reset if WDT is not enabled 
  76:Drivers/Library/StdDriver/src/retarget.c ****  */
  77:Drivers/Library/StdDriver/src/retarget.c **** void Hard_Fault_Handler(uint32_t stack[])
  78:Drivers/Library/StdDriver/src/retarget.c **** {
 183              		.loc 1 78 1
 184              		.cfi_startproc
 185              		@ args = 0, pretend = 0, frame = 8
 186              		@ frame_needed = 1, uses_anonymous_args = 0
 187 0000 80B5     		push	{r7, lr}
 188              	.LCFI5:
 189              		.cfi_def_cfa_offset 8
 190              		.cfi_offset 7, -8
 191              		.cfi_offset 14, -4
 192 0002 82B0     		sub	sp, sp, #8
 193              	.LCFI6:
 194              		.cfi_def_cfa_offset 16
 195 0004 00AF     		add	r7, sp, #0
 196              	.LCFI7:
 197              		.cfi_def_cfa_register 7
 198 0006 7860     		str	r0, [r7, #4]
  79:Drivers/Library/StdDriver/src/retarget.c ****     printf("In Hard Fault Handler\n");
 199              		.loc 1 79 5
 200 0008 0348     		ldr	r0, .L6
 201 000a FFF7FEFF 		bl	puts
  80:Drivers/Library/StdDriver/src/retarget.c **** 
  81:Drivers/Library/StdDriver/src/retarget.c ****     stackDump(stack);
 202              		.loc 1 81 5
 203 000e 7868     		ldr	r0, [r7, #4]
 204 0010 FFF7FEFF 		bl	stackDump
 205              	.L5:
  82:Drivers/Library/StdDriver/src/retarget.c ****     /* Replace while(1) with chip reset if WDT is not enabled for end product */
  83:Drivers/Library/StdDriver/src/retarget.c ****     while(1);
 206              		.loc 1 83 10 discriminator 1
 207 0014 FEE7     		b	.L5
 208              	.L7:
 209 0016 00BF     		.align	2
 210              	.L6:
 211 0018 80000000 		.word	.LC8
 212              		.cfi_endproc
 213              	.LFE196:
 215              		.section	.text.HardFault_Handler,"ax",%progbits
 216              		.align	1
 217              		.global	HardFault_Handler
 218              		.syntax unified
 219              		.thumb
 220              		.thumb_func
 221              		.fpu fpv4-sp-d16
 223              	HardFault_Handler:
 224              	.LFB197:
  84:Drivers/Library/StdDriver/src/retarget.c ****     /* SYS->IPRST0 = SYS_IPRST0_CHIPRST_Msk; */
  85:Drivers/Library/StdDriver/src/retarget.c **** }
  86:Drivers/Library/StdDriver/src/retarget.c **** 
  87:Drivers/Library/StdDriver/src/retarget.c **** 
  88:Drivers/Library/StdDriver/src/retarget.c **** 
  89:Drivers/Library/StdDriver/src/retarget.c **** /*-------------------------------------------------------------------------------------------------
  90:Drivers/Library/StdDriver/src/retarget.c **** /* Routine to write a char                                                                         
  91:Drivers/Library/StdDriver/src/retarget.c **** /*-------------------------------------------------------------------------------------------------
ARM GAS  /tmp/cccbhmYm.s 			page 7


  92:Drivers/Library/StdDriver/src/retarget.c **** 
  93:Drivers/Library/StdDriver/src/retarget.c **** #if defined(DEBUG_ENABLE_SEMIHOST)
  94:Drivers/Library/StdDriver/src/retarget.c **** /* The static buffer is used to speed up the semihost    */
  95:Drivers/Library/StdDriver/src/retarget.c **** static char g_buf[16];
  96:Drivers/Library/StdDriver/src/retarget.c **** static char g_buf_len = 0;
  97:Drivers/Library/StdDriver/src/retarget.c **** 
  98:Drivers/Library/StdDriver/src/retarget.c **** /* Make sure won't goes here only because --gnu is defined , so
  99:Drivers/Library/StdDriver/src/retarget.c ****    add !__CC_ARM and !__ICCARM__ checking */
 100:Drivers/Library/StdDriver/src/retarget.c **** # if defined ( __GNUC__ ) && !(__CC_ARM) && !(__ICCARM__)
 101:Drivers/Library/StdDriver/src/retarget.c **** 
 102:Drivers/Library/StdDriver/src/retarget.c **** # elif defined(__ICCARM__)      // IAR
 103:Drivers/Library/StdDriver/src/retarget.c **** 
 104:Drivers/Library/StdDriver/src/retarget.c **** void SH_End(void)
 105:Drivers/Library/StdDriver/src/retarget.c **** {
 106:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOVS   R0,#1 \n"        /*; Set return value to 1 */
 107:Drivers/Library/StdDriver/src/retarget.c ****         "BX     lr    \n"        /*; Return */
 108:Drivers/Library/StdDriver/src/retarget.c ****        );
 109:Drivers/Library/StdDriver/src/retarget.c **** }
 110:Drivers/Library/StdDriver/src/retarget.c **** 
 111:Drivers/Library/StdDriver/src/retarget.c **** void SH_ICE(void)
 112:Drivers/Library/StdDriver/src/retarget.c **** {
 113:Drivers/Library/StdDriver/src/retarget.c ****   asm("CMP   R2,#0   \n"
 114:Drivers/Library/StdDriver/src/retarget.c ****       "BEQ   SH_End  \n"
 115:Drivers/Library/StdDriver/src/retarget.c ****       "STR   R0,[R2] \n"       /*; Save the return value to *pn32Out_R0 */
 116:Drivers/Library/StdDriver/src/retarget.c ****      );
 117:Drivers/Library/StdDriver/src/retarget.c **** }
 118:Drivers/Library/StdDriver/src/retarget.c **** 
 119:Drivers/Library/StdDriver/src/retarget.c **** /**
 120:Drivers/Library/StdDriver/src/retarget.c ****  *
 121:Drivers/Library/StdDriver/src/retarget.c ****  * @brief      The function to process semihosted command
 122:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]  n32In_R0  : semihost register 0
 123:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]  n32In_R1  : semihost register 1
 124:Drivers/Library/StdDriver/src/retarget.c ****  * @param[out] pn32Out_R0: semihost register 0
 125:Drivers/Library/StdDriver/src/retarget.c ****  * @retval     0: No ICE debug
 126:Drivers/Library/StdDriver/src/retarget.c ****  * @retval     1: ICE debug
 127:Drivers/Library/StdDriver/src/retarget.c ****  *
 128:Drivers/Library/StdDriver/src/retarget.c ****  */
 129:Drivers/Library/StdDriver/src/retarget.c **** int32_t SH_DoCommand(int32_t n32In_R0, int32_t n32In_R1, int32_t *pn32Out_R0)
 130:Drivers/Library/StdDriver/src/retarget.c **** {
 131:Drivers/Library/StdDriver/src/retarget.c ****     asm("BKPT   0xAB   \n"       /*; This instruction will cause ICE trap or system HardFault */
 132:Drivers/Library/StdDriver/src/retarget.c ****         "B      SH_ICE \n"
 133:Drivers/Library/StdDriver/src/retarget.c ****         "SH_HardFault: \n"       /*; Captured by HardFault */
 134:Drivers/Library/StdDriver/src/retarget.c ****         "MOVS   R0,#0  \n"       /*; Set return value to 0 */
 135:Drivers/Library/StdDriver/src/retarget.c ****         "BX     lr     \n"       /*; Return */
 136:Drivers/Library/StdDriver/src/retarget.c ****         );
 137:Drivers/Library/StdDriver/src/retarget.c **** 
 138:Drivers/Library/StdDriver/src/retarget.c ****     return 1;                    /*; Return 1 when it is trap by ICE */
 139:Drivers/Library/StdDriver/src/retarget.c **** }
 140:Drivers/Library/StdDriver/src/retarget.c **** 
 141:Drivers/Library/StdDriver/src/retarget.c **** /**
 142:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Get LR value and branch to Hard_Fault_Handler function
 143:Drivers/Library/StdDriver/src/retarget.c ****  * @param       None
 144:Drivers/Library/StdDriver/src/retarget.c ****  * @return      None
 145:Drivers/Library/StdDriver/src/retarget.c ****  * @details     This function is use to get LR value and branch to Hard_Fault_Handler function.
 146:Drivers/Library/StdDriver/src/retarget.c ****  */
 147:Drivers/Library/StdDriver/src/retarget.c **** void Get_LR_and_Branch(void)
 148:Drivers/Library/StdDriver/src/retarget.c **** {
ARM GAS  /tmp/cccbhmYm.s 			page 8


 149:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOV     R1, LR               \n" /*; LR current value */
 150:Drivers/Library/StdDriver/src/retarget.c ****         "B       Hard_Fault_Handler   \n"
 151:Drivers/Library/StdDriver/src/retarget.c ****        );
 152:Drivers/Library/StdDriver/src/retarget.c **** }
 153:Drivers/Library/StdDriver/src/retarget.c **** 
 154:Drivers/Library/StdDriver/src/retarget.c **** /**
 155:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Get MSP value and branch to Get_LR_and_Branch function
 156:Drivers/Library/StdDriver/src/retarget.c ****  * @param       None
 157:Drivers/Library/StdDriver/src/retarget.c ****  * @return      None
 158:Drivers/Library/StdDriver/src/retarget.c ****  * @details     This function is use to get stack pointer value and branch to Get_LR_and_Branch fun
 159:Drivers/Library/StdDriver/src/retarget.c ****  */
 160:Drivers/Library/StdDriver/src/retarget.c **** void Stack_Use_MSP(void)
 161:Drivers/Library/StdDriver/src/retarget.c **** {
 162:Drivers/Library/StdDriver/src/retarget.c ****     asm("MRS     R0, MSP           \n" /*; read MSP */
 163:Drivers/Library/StdDriver/src/retarget.c ****         "B       Get_LR_and_Branch \n"
 164:Drivers/Library/StdDriver/src/retarget.c ****        );
 165:Drivers/Library/StdDriver/src/retarget.c **** }
 166:Drivers/Library/StdDriver/src/retarget.c **** 
 167:Drivers/Library/StdDriver/src/retarget.c **** /**
 168:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Get stack pointer value and branch to Get_LR_and_Branch function
 169:Drivers/Library/StdDriver/src/retarget.c ****  * @param       None
 170:Drivers/Library/StdDriver/src/retarget.c ****  * @return      None
 171:Drivers/Library/StdDriver/src/retarget.c ****  * @details     This function is use to get stack pointer value and branch to Get_LR_and_Branch fun
 172:Drivers/Library/StdDriver/src/retarget.c ****  */
 173:Drivers/Library/StdDriver/src/retarget.c **** void HardFault_Handler_Ret(void)
 174:Drivers/Library/StdDriver/src/retarget.c **** {
 175:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOVS    r0, #4                        \n"
 176:Drivers/Library/StdDriver/src/retarget.c ****         "MOV     r1, LR                        \n"
 177:Drivers/Library/StdDriver/src/retarget.c ****         "TST     r0, r1                        \n" /*; check LR bit 2 */
 178:Drivers/Library/StdDriver/src/retarget.c ****         "BEQ     Stack_Use_MSP                 \n" /*; stack use MSP */
 179:Drivers/Library/StdDriver/src/retarget.c ****         "MRS     R0, PSP                       \n" /*; stack use PSP, read PSP */
 180:Drivers/Library/StdDriver/src/retarget.c ****         "B       Get_LR_and_Branch             \n"
 181:Drivers/Library/StdDriver/src/retarget.c ****        );
 182:Drivers/Library/StdDriver/src/retarget.c **** }
 183:Drivers/Library/StdDriver/src/retarget.c **** 
 184:Drivers/Library/StdDriver/src/retarget.c **** /**
 185:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    This function is implemented to support semihost
 186:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 187:Drivers/Library/StdDriver/src/retarget.c ****  * @returns  None
 188:Drivers/Library/StdDriver/src/retarget.c ****  * @details  This function is implement to support semihost message print.
 189:Drivers/Library/StdDriver/src/retarget.c ****  *
 190:Drivers/Library/StdDriver/src/retarget.c ****  */
 191:Drivers/Library/StdDriver/src/retarget.c **** void SP_Read_Ready(void)
 192:Drivers/Library/StdDriver/src/retarget.c **** {
 193:Drivers/Library/StdDriver/src/retarget.c ****     asm("LDR     R1, [R0, #24] \n"        /*; Get previous PC */
 194:Drivers/Library/StdDriver/src/retarget.c ****         "LDRH    R3, [R1]      \n"        /*; Get instruction */
 195:Drivers/Library/StdDriver/src/retarget.c ****         "LDR     R2, [pc, #8]  \n"        /*; The special BKPT instruction */
 196:Drivers/Library/StdDriver/src/retarget.c ****         "CMP     R3, R2        \n"        /*; Test if the instruction at previous PC is BKPT */
 197:Drivers/Library/StdDriver/src/retarget.c ****         "BNE     HardFault_Handler_Ret \n" /*; Not BKPT */
 198:Drivers/Library/StdDriver/src/retarget.c ****         "ADDS    R1, #4        \n"        /*; Skip BKPT and next line */
 199:Drivers/Library/StdDriver/src/retarget.c ****         "STR     R1, [R0, #24] \n"        /*; Save previous PC */
 200:Drivers/Library/StdDriver/src/retarget.c ****         "BX      lr            \n"        /*; Return */
 201:Drivers/Library/StdDriver/src/retarget.c ****         "DCD     0xBEAB        \n"        /*; BKPT instruction code */
 202:Drivers/Library/StdDriver/src/retarget.c ****         "B       HardFault_Handler_Ret \n"
 203:Drivers/Library/StdDriver/src/retarget.c ****        );
 204:Drivers/Library/StdDriver/src/retarget.c **** }
 205:Drivers/Library/StdDriver/src/retarget.c **** 
ARM GAS  /tmp/cccbhmYm.s 			page 9


 206:Drivers/Library/StdDriver/src/retarget.c **** /**
 207:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Get stack pointer value and branch to Get_LR_and_Branch function
 208:Drivers/Library/StdDriver/src/retarget.c ****  * @param       None
 209:Drivers/Library/StdDriver/src/retarget.c ****  * @return      None
 210:Drivers/Library/StdDriver/src/retarget.c ****  * @details     This function is use to get stack pointer value and branch to Get_LR_and_Branch fun
 211:Drivers/Library/StdDriver/src/retarget.c ****  */
 212:Drivers/Library/StdDriver/src/retarget.c **** void SP_is_PSP(void)
 213:Drivers/Library/StdDriver/src/retarget.c **** {
 214:Drivers/Library/StdDriver/src/retarget.c ****     asm(
 215:Drivers/Library/StdDriver/src/retarget.c ****         "MRS     R0, PSP       \n"      /*; stack use PSP, read PSP */
 216:Drivers/Library/StdDriver/src/retarget.c ****         "B       Get_LR_and_Branch    \n"
 217:Drivers/Library/StdDriver/src/retarget.c **** 
 218:Drivers/Library/StdDriver/src/retarget.c ****        );
 219:Drivers/Library/StdDriver/src/retarget.c **** }
 220:Drivers/Library/StdDriver/src/retarget.c **** 
 221:Drivers/Library/StdDriver/src/retarget.c **** /**
 222:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    This HardFault handler is implemented to support semihost
 223:Drivers/Library/StdDriver/src/retarget.c ****  *
 224:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 225:Drivers/Library/StdDriver/src/retarget.c ****  *
 226:Drivers/Library/StdDriver/src/retarget.c ****  * @returns  None
 227:Drivers/Library/StdDriver/src/retarget.c ****  *
 228:Drivers/Library/StdDriver/src/retarget.c ****  * @details  This function is implement to support semihost message print.
 229:Drivers/Library/StdDriver/src/retarget.c ****  *
 230:Drivers/Library/StdDriver/src/retarget.c ****  */
 231:Drivers/Library/StdDriver/src/retarget.c **** void HardFault_Handler (void)
 232:Drivers/Library/StdDriver/src/retarget.c **** {
 233:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOV     R0, lr        \n"
 234:Drivers/Library/StdDriver/src/retarget.c ****         "LSLS    R0, #29       \n"        /*; Check bit 2 */
 235:Drivers/Library/StdDriver/src/retarget.c ****         "BMI     SP_is_PSP     \n"        /*; previous stack is PSP */
 236:Drivers/Library/StdDriver/src/retarget.c ****         "MRS     R0, MSP       \n"        /*; previous stack is MSP, read MSP */
 237:Drivers/Library/StdDriver/src/retarget.c ****         "B       SP_Read_Ready \n"
 238:Drivers/Library/StdDriver/src/retarget.c ****        );
 239:Drivers/Library/StdDriver/src/retarget.c **** 
 240:Drivers/Library/StdDriver/src/retarget.c ****     while(1);
 241:Drivers/Library/StdDriver/src/retarget.c **** }
 242:Drivers/Library/StdDriver/src/retarget.c **** 
 243:Drivers/Library/StdDriver/src/retarget.c **** # else
 244:Drivers/Library/StdDriver/src/retarget.c **** 
 245:Drivers/Library/StdDriver/src/retarget.c **** /**
 246:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    This HardFault handler is implemented to support semihost
 247:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 248:Drivers/Library/StdDriver/src/retarget.c ****  * @returns  None
 249:Drivers/Library/StdDriver/src/retarget.c ****  * @details  This function is implement to support semihost message print.
 250:Drivers/Library/StdDriver/src/retarget.c ****  *
 251:Drivers/Library/StdDriver/src/retarget.c ****  */
 252:Drivers/Library/StdDriver/src/retarget.c **** __asm int32_t HardFault_Handler(void)
 253:Drivers/Library/StdDriver/src/retarget.c **** {
 254:Drivers/Library/StdDriver/src/retarget.c ****     MOV     R0, LR
 255:Drivers/Library/StdDriver/src/retarget.c ****     LSLS    R0, #29               /*; Check bit 2 */
 256:Drivers/Library/StdDriver/src/retarget.c ****     BMI     SP_is_PSP             /*; previous stack is PSP */
 257:Drivers/Library/StdDriver/src/retarget.c ****     MRS     R0, MSP               /*; previous stack is MSP, read MSP */
 258:Drivers/Library/StdDriver/src/retarget.c ****     B       SP_Read_Ready
 259:Drivers/Library/StdDriver/src/retarget.c **** SP_is_PSP
 260:Drivers/Library/StdDriver/src/retarget.c ****     MRS     R0, PSP               /*; Read PSP */
 261:Drivers/Library/StdDriver/src/retarget.c **** 
 262:Drivers/Library/StdDriver/src/retarget.c **** SP_Read_Ready
ARM GAS  /tmp/cccbhmYm.s 			page 10


 263:Drivers/Library/StdDriver/src/retarget.c ****     LDR     R1, [R0, #24]         /*; Get previous PC */
 264:Drivers/Library/StdDriver/src/retarget.c ****     LDRH    R3, [R1]              /*; Get instruction */
 265:Drivers/Library/StdDriver/src/retarget.c ****     LDR     R2, =0xBEAB           /*; The special BKPT instruction */
 266:Drivers/Library/StdDriver/src/retarget.c ****     CMP     R3, R2                /*; Test if the instruction at previous PC is BKPT */
 267:Drivers/Library/StdDriver/src/retarget.c ****     BNE     HardFault_Handler_Ret /*; Not BKPT */
 268:Drivers/Library/StdDriver/src/retarget.c **** 
 269:Drivers/Library/StdDriver/src/retarget.c ****     ADDS    R1, #4                /*; Skip BKPT and next line */
 270:Drivers/Library/StdDriver/src/retarget.c ****     STR     R1, [R0, #24]         /*; Save previous PC */
 271:Drivers/Library/StdDriver/src/retarget.c **** 
 272:Drivers/Library/StdDriver/src/retarget.c ****     BX      LR                    /*; Return */
 273:Drivers/Library/StdDriver/src/retarget.c **** HardFault_Handler_Ret
 274:Drivers/Library/StdDriver/src/retarget.c **** 
 275:Drivers/Library/StdDriver/src/retarget.c ****     /* TODO: Implement your own hard fault handler here. */
 276:Drivers/Library/StdDriver/src/retarget.c ****     MOVS    r0, #4
 277:Drivers/Library/StdDriver/src/retarget.c ****     MOV     r1, LR
 278:Drivers/Library/StdDriver/src/retarget.c ****     TST     r0, r1                          /*; check LR bit 2 */
 279:Drivers/Library/StdDriver/src/retarget.c ****     BEQ     Stack_Use_MSP                   /*; stack use MSP */
 280:Drivers/Library/StdDriver/src/retarget.c ****     MRS     R0, PSP ;stack use PSP          /*; stack use PSP, read PSP */
 281:Drivers/Library/StdDriver/src/retarget.c ****     B       Get_LR_and_Branch
 282:Drivers/Library/StdDriver/src/retarget.c **** Stack_Use_MSP
 283:Drivers/Library/StdDriver/src/retarget.c ****     MRS     R0, MSP ; stack use MSP         /*; read MSP */
 284:Drivers/Library/StdDriver/src/retarget.c **** Get_LR_and_Branch
 285:Drivers/Library/StdDriver/src/retarget.c ****     MOV     R1, LR ; LR current value       /*; LR current value */
 286:Drivers/Library/StdDriver/src/retarget.c ****     LDR     R2,=__cpp(Hard_Fault_Handler)   /*; branch to Hard_Fault_Handler */
 287:Drivers/Library/StdDriver/src/retarget.c ****     BX      R2
 288:Drivers/Library/StdDriver/src/retarget.c **** 
 289:Drivers/Library/StdDriver/src/retarget.c ****     B       .
 290:Drivers/Library/StdDriver/src/retarget.c **** 
 291:Drivers/Library/StdDriver/src/retarget.c ****     ALIGN
 292:Drivers/Library/StdDriver/src/retarget.c **** }
 293:Drivers/Library/StdDriver/src/retarget.c **** 
 294:Drivers/Library/StdDriver/src/retarget.c **** /**
 295:Drivers/Library/StdDriver/src/retarget.c ****  *
 296:Drivers/Library/StdDriver/src/retarget.c ****  * @brief      The function to process semihosted command
 297:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]  n32In_R0  : semihost register 0
 298:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]  n32In_R1  : semihost register 1
 299:Drivers/Library/StdDriver/src/retarget.c ****  * @param[out] pn32Out_R0: semihost register 0
 300:Drivers/Library/StdDriver/src/retarget.c ****  * @retval     0: No ICE debug
 301:Drivers/Library/StdDriver/src/retarget.c ****  * @retval     1: ICE debug
 302:Drivers/Library/StdDriver/src/retarget.c ****  *
 303:Drivers/Library/StdDriver/src/retarget.c ****  */
 304:Drivers/Library/StdDriver/src/retarget.c **** __asm int32_t SH_DoCommand(int32_t n32In_R0, int32_t n32In_R1, int32_t *pn32Out_R0)
 305:Drivers/Library/StdDriver/src/retarget.c **** {
 306:Drivers/Library/StdDriver/src/retarget.c ****     BKPT   0xAB          /*; Wait ICE or HardFault */
 307:Drivers/Library/StdDriver/src/retarget.c ****     /*; ICE will step over BKPT directly
 308:Drivers/Library/StdDriver/src/retarget.c ****       ; HardFault will step BKPT and the next line */
 309:Drivers/Library/StdDriver/src/retarget.c ****     B      SH_ICE
 310:Drivers/Library/StdDriver/src/retarget.c **** 
 311:Drivers/Library/StdDriver/src/retarget.c **** SH_HardFault             /*; Captured by HardFault */
 312:Drivers/Library/StdDriver/src/retarget.c ****     MOVS   R0, #0        /*; Set return value to 0 */
 313:Drivers/Library/StdDriver/src/retarget.c ****     BX     lr            /*; Return */
 314:Drivers/Library/StdDriver/src/retarget.c **** 
 315:Drivers/Library/StdDriver/src/retarget.c **** SH_ICE                   /*; Captured by ICE */
 316:Drivers/Library/StdDriver/src/retarget.c ****     /*; Save return value */
 317:Drivers/Library/StdDriver/src/retarget.c ****     CMP    R2, #0
 318:Drivers/Library/StdDriver/src/retarget.c ****     BEQ    SH_End
 319:Drivers/Library/StdDriver/src/retarget.c ****     STR    R0, [R2]      /*; Save the return value to *pn32Out_R0 */
ARM GAS  /tmp/cccbhmYm.s 			page 11


 320:Drivers/Library/StdDriver/src/retarget.c **** 
 321:Drivers/Library/StdDriver/src/retarget.c **** SH_End
 322:Drivers/Library/StdDriver/src/retarget.c ****     MOVS   R0, #1        /*; Set return value to 1 */
 323:Drivers/Library/StdDriver/src/retarget.c ****     BX     lr            /*; Return */
 324:Drivers/Library/StdDriver/src/retarget.c **** }
 325:Drivers/Library/StdDriver/src/retarget.c **** #endif
 326:Drivers/Library/StdDriver/src/retarget.c **** 
 327:Drivers/Library/StdDriver/src/retarget.c **** #else   // ndef DEBUG_ENABLE_SEMIHOST
 328:Drivers/Library/StdDriver/src/retarget.c **** 
 329:Drivers/Library/StdDriver/src/retarget.c **** /* Make sure won't goes here only because --gnu is defined , so
 330:Drivers/Library/StdDriver/src/retarget.c ****    add !__CC_ARM and !__ICCARM__ checking */
 331:Drivers/Library/StdDriver/src/retarget.c **** # if defined ( __GNUC__ ) && !(__CC_ARM) && !(__ICCARM__) 
 332:Drivers/Library/StdDriver/src/retarget.c **** 
 333:Drivers/Library/StdDriver/src/retarget.c **** /**
 334:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    This HardFault handler is implemented to show r0, r1, r2, r3, r12, lr, pc, psr
 335:Drivers/Library/StdDriver/src/retarget.c ****  *
 336:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 337:Drivers/Library/StdDriver/src/retarget.c ****  *
 338:Drivers/Library/StdDriver/src/retarget.c ****  * @returns  None
 339:Drivers/Library/StdDriver/src/retarget.c ****  *
 340:Drivers/Library/StdDriver/src/retarget.c ****  * @details  This function is implement to print r0, r1, r2, r3, r12, lr, pc, psr.
 341:Drivers/Library/StdDriver/src/retarget.c ****  *
 342:Drivers/Library/StdDriver/src/retarget.c ****  */
 343:Drivers/Library/StdDriver/src/retarget.c **** void HardFault_Handler(void)
 344:Drivers/Library/StdDriver/src/retarget.c **** {
 225              		.loc 1 344 1
 226              		.cfi_startproc
 227              		@ args = 0, pretend = 0, frame = 0
 228              		@ frame_needed = 1, uses_anonymous_args = 0
 229              		@ link register save eliminated.
 230 0000 80B4     		push	{r7}
 231              	.LCFI8:
 232              		.cfi_def_cfa_offset 4
 233              		.cfi_offset 7, -4
 234 0002 00AF     		add	r7, sp, #0
 235              	.LCFI9:
 236              		.cfi_def_cfa_register 7
 345:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOVS    r0, #4                        \n"
 237              		.loc 1 345 5
 238 0004 074B     		ldr	r3, .L10
 239              		.syntax unified
 240              	@ 345 "Drivers/Library/StdDriver/src/retarget.c" 1
 241 0006 0420     		MOVS    r0, #4                        
 242 0008 7146     	MOV     r1, LR                        
 243 000a 0842     	TST     r0, r1                        
 244 000c 04D0     	BEQ     1f                            
 245 000e EFF30980 	MRS     R0, PSP                       
 246 0012 7146     	MOV     R1, LR                        
 247 0014 FFF7FEBF 	B       Hard_Fault_Handler            
 248              	1:                                    
 249 0018 EFF30880 	MRS     R0, MSP                       
 250 001c FFF7FEBF 	B       Hard_Fault_Handler            
 251              	
 252              	@ 0 "" 2
 253              		.thumb
 254              		.syntax unified
 255              	.L9:
ARM GAS  /tmp/cccbhmYm.s 			page 12


 346:Drivers/Library/StdDriver/src/retarget.c ****         "MOV     r1, LR                        \n"
 347:Drivers/Library/StdDriver/src/retarget.c ****         "TST     r0, r1                        \n" /*; check LR bit 2 */
 348:Drivers/Library/StdDriver/src/retarget.c ****         "BEQ     1f                            \n" /*; stack use MSP */
 349:Drivers/Library/StdDriver/src/retarget.c ****         "MRS     R0, PSP                       \n" /*; stack use PSP, read PSP */
 350:Drivers/Library/StdDriver/src/retarget.c ****         "MOV     R1, LR                        \n" /*; LR current value */
 351:Drivers/Library/StdDriver/src/retarget.c ****         "B       Hard_Fault_Handler            \n"
 352:Drivers/Library/StdDriver/src/retarget.c ****         "1:                                    \n"
 353:Drivers/Library/StdDriver/src/retarget.c ****         "MRS     R0, MSP                       \n" /*; LR current value */
 354:Drivers/Library/StdDriver/src/retarget.c ****         "B       Hard_Fault_Handler            \n"    
 355:Drivers/Library/StdDriver/src/retarget.c ****         ::[Hard_Fault_Handler] "r" (Hard_Fault_Handler) // input
 356:Drivers/Library/StdDriver/src/retarget.c ****     );
 357:Drivers/Library/StdDriver/src/retarget.c ****     while(1);
 256              		.loc 1 357 10 discriminator 1
 257 0020 FEE7     		b	.L9
 258              	.L11:
 259 0022 00BF     		.align	2
 260              	.L10:
 261 0024 00000000 		.word	Hard_Fault_Handler
 262              		.cfi_endproc
 263              	.LFE197:
 265              		.section	.text.SendChar_ToUART,"ax",%progbits
 266              		.align	1
 267              		.syntax unified
 268              		.thumb
 269              		.thumb_func
 270              		.fpu fpv4-sp-d16
 272              	SendChar_ToUART:
 273              	.LFB198:
 358:Drivers/Library/StdDriver/src/retarget.c **** }
 359:Drivers/Library/StdDriver/src/retarget.c **** 
 360:Drivers/Library/StdDriver/src/retarget.c **** # elif defined(__ICCARM__)
 361:Drivers/Library/StdDriver/src/retarget.c **** 
 362:Drivers/Library/StdDriver/src/retarget.c **** void Get_LR_and_Branch(void)
 363:Drivers/Library/StdDriver/src/retarget.c **** {
 364:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOV     R1, LR                  \n" /*; LR current value */
 365:Drivers/Library/StdDriver/src/retarget.c ****         "B       Hard_Fault_Handler      \n"
 366:Drivers/Library/StdDriver/src/retarget.c ****        );
 367:Drivers/Library/StdDriver/src/retarget.c **** }
 368:Drivers/Library/StdDriver/src/retarget.c **** 
 369:Drivers/Library/StdDriver/src/retarget.c **** void Stack_Use_MSP(void)
 370:Drivers/Library/StdDriver/src/retarget.c **** {
 371:Drivers/Library/StdDriver/src/retarget.c ****     asm("MRS     R0, MSP           \n" /*; read MSP */
 372:Drivers/Library/StdDriver/src/retarget.c ****         "B       Get_LR_and_Branch \n"
 373:Drivers/Library/StdDriver/src/retarget.c ****        );
 374:Drivers/Library/StdDriver/src/retarget.c **** }
 375:Drivers/Library/StdDriver/src/retarget.c **** 
 376:Drivers/Library/StdDriver/src/retarget.c **** /**
 377:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    This HardFault handler is implemented to show r0, r1, r2, r3, r12, lr, pc, psr
 378:Drivers/Library/StdDriver/src/retarget.c ****  *
 379:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 380:Drivers/Library/StdDriver/src/retarget.c ****  *
 381:Drivers/Library/StdDriver/src/retarget.c ****  * @returns  None
 382:Drivers/Library/StdDriver/src/retarget.c ****  *
 383:Drivers/Library/StdDriver/src/retarget.c ****  * @details  This function is implement to print r0, r1, r2, r3, r12, lr, pc, psr.
 384:Drivers/Library/StdDriver/src/retarget.c ****  *
 385:Drivers/Library/StdDriver/src/retarget.c ****  */
 386:Drivers/Library/StdDriver/src/retarget.c **** void HardFault_Handler(void)
ARM GAS  /tmp/cccbhmYm.s 			page 13


 387:Drivers/Library/StdDriver/src/retarget.c **** {
 388:Drivers/Library/StdDriver/src/retarget.c ****     asm("MOVS    r0, #4                        \n"
 389:Drivers/Library/StdDriver/src/retarget.c ****         "MOV     r1, LR                        \n"
 390:Drivers/Library/StdDriver/src/retarget.c ****         "TST     r0, r1                        \n" /*; check LR bit 2 */
 391:Drivers/Library/StdDriver/src/retarget.c ****         "BEQ     Stack_Use_MSP                 \n" /*; stack use MSP */
 392:Drivers/Library/StdDriver/src/retarget.c ****         "MRS     R0, PSP                       \n" /*; stack use PSP, read PSP */
 393:Drivers/Library/StdDriver/src/retarget.c ****         "B       Get_LR_and_Branch             \n"
 394:Drivers/Library/StdDriver/src/retarget.c ****        );
 395:Drivers/Library/StdDriver/src/retarget.c **** 
 396:Drivers/Library/StdDriver/src/retarget.c ****     while(1);
 397:Drivers/Library/StdDriver/src/retarget.c **** }
 398:Drivers/Library/StdDriver/src/retarget.c **** 
 399:Drivers/Library/StdDriver/src/retarget.c **** # else
 400:Drivers/Library/StdDriver/src/retarget.c **** 
 401:Drivers/Library/StdDriver/src/retarget.c **** /**
 402:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    This HardFault handler is implemented to show r0, r1, r2, r3, r12, lr, pc, psr
 403:Drivers/Library/StdDriver/src/retarget.c ****  *
 404:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 405:Drivers/Library/StdDriver/src/retarget.c ****  *
 406:Drivers/Library/StdDriver/src/retarget.c ****  * @return   None
 407:Drivers/Library/StdDriver/src/retarget.c ****  *
 408:Drivers/Library/StdDriver/src/retarget.c ****  * @details  The function extracts the location of stack frame and passes it to Hard_Fault_Handler 
 409:Drivers/Library/StdDriver/src/retarget.c ****  *
 410:Drivers/Library/StdDriver/src/retarget.c ****  */
 411:Drivers/Library/StdDriver/src/retarget.c **** __asm int32_t HardFault_Handler(void)
 412:Drivers/Library/StdDriver/src/retarget.c **** {
 413:Drivers/Library/StdDriver/src/retarget.c ****     MOVS    r0, #4
 414:Drivers/Library/StdDriver/src/retarget.c ****     MOV     r1, LR
 415:Drivers/Library/StdDriver/src/retarget.c ****     TST     r0, r1          /*; check LR bit 2 */
 416:Drivers/Library/StdDriver/src/retarget.c ****     BEQ     Stack_Use_MSP   /*; stack use MSP */
 417:Drivers/Library/StdDriver/src/retarget.c ****     MRS     R0, PSP         /*; stack use PSP, read PSP */
 418:Drivers/Library/StdDriver/src/retarget.c ****     B       Get_LR_and_Branch
 419:Drivers/Library/StdDriver/src/retarget.c **** Stack_Use_MSP
 420:Drivers/Library/StdDriver/src/retarget.c ****     MRS     R0, MSP         /*; read MSP */
 421:Drivers/Library/StdDriver/src/retarget.c **** Get_LR_and_Branch
 422:Drivers/Library/StdDriver/src/retarget.c ****     MOV     R1, LR          /*; LR current value */
 423:Drivers/Library/StdDriver/src/retarget.c ****     LDR     R2,=__cpp(Hard_Fault_Handler) /*; branch to Hard_Fault_Handler */
 424:Drivers/Library/StdDriver/src/retarget.c ****     BX      R2
 425:Drivers/Library/StdDriver/src/retarget.c **** }
 426:Drivers/Library/StdDriver/src/retarget.c **** 
 427:Drivers/Library/StdDriver/src/retarget.c **** #endif
 428:Drivers/Library/StdDriver/src/retarget.c **** 
 429:Drivers/Library/StdDriver/src/retarget.c **** #endif
 430:Drivers/Library/StdDriver/src/retarget.c **** 
 431:Drivers/Library/StdDriver/src/retarget.c **** #ifndef DISABLE_UART
 432:Drivers/Library/StdDriver/src/retarget.c **** /**
 433:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Routine to send a char
 434:Drivers/Library/StdDriver/src/retarget.c ****  *
 435:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]   ch Character to send to debug port.
 436:Drivers/Library/StdDriver/src/retarget.c ****  *
 437:Drivers/Library/StdDriver/src/retarget.c ****  * @returns     Send value from UART debug port
 438:Drivers/Library/StdDriver/src/retarget.c ****  *
 439:Drivers/Library/StdDriver/src/retarget.c ****  * @details     Send a target char to UART debug port .
 440:Drivers/Library/StdDriver/src/retarget.c ****  */
 441:Drivers/Library/StdDriver/src/retarget.c **** #ifndef NONBLOCK_PRINTF
 442:Drivers/Library/StdDriver/src/retarget.c **** static void SendChar_ToUART(int ch)
 443:Drivers/Library/StdDriver/src/retarget.c **** {
ARM GAS  /tmp/cccbhmYm.s 			page 14


 274              		.loc 1 443 1
 275              		.cfi_startproc
 276              		@ args = 0, pretend = 0, frame = 8
 277              		@ frame_needed = 1, uses_anonymous_args = 0
 278              		@ link register save eliminated.
 279 0000 80B4     		push	{r7}
 280              	.LCFI10:
 281              		.cfi_def_cfa_offset 4
 282              		.cfi_offset 7, -4
 283 0002 83B0     		sub	sp, sp, #12
 284              	.LCFI11:
 285              		.cfi_def_cfa_offset 16
 286 0004 00AF     		add	r7, sp, #0
 287              	.LCFI12:
 288              		.cfi_def_cfa_register 7
 289 0006 7860     		str	r0, [r7, #4]
 444:Drivers/Library/StdDriver/src/retarget.c ****     while(DEBUG_PORT->FIFOSTS & UART_FIFOSTS_TXFULL_Msk);
 290              		.loc 1 444 10
 291 0008 00BF     		nop
 292              	.L13:
 293              		.loc 1 444 21 discriminator 1
 294 000a 0E4B     		ldr	r3, .L16
 295 000c 9B69     		ldr	r3, [r3, #24]
 296              		.loc 1 444 31 discriminator 1
 297 000e 03F40003 		and	r3, r3, #8388608
 298              		.loc 1 444 10 discriminator 1
 299 0012 002B     		cmp	r3, #0
 300 0014 F9D1     		bne	.L13
 445:Drivers/Library/StdDriver/src/retarget.c **** 
 446:Drivers/Library/StdDriver/src/retarget.c ****     if(ch == '\n')
 301              		.loc 1 446 7
 302 0016 7B68     		ldr	r3, [r7, #4]
 303 0018 0A2B     		cmp	r3, #10
 304 001a 09D1     		bne	.L14
 447:Drivers/Library/StdDriver/src/retarget.c ****     {
 448:Drivers/Library/StdDriver/src/retarget.c ****         DEBUG_PORT->DAT = '\r';
 305              		.loc 1 448 19
 306 001c 094B     		ldr	r3, .L16
 307              		.loc 1 448 25
 308 001e 0D22     		movs	r2, #13
 309 0020 1A60     		str	r2, [r3]
 449:Drivers/Library/StdDriver/src/retarget.c ****         while(DEBUG_PORT->FIFOSTS & UART_FIFOSTS_TXFULL_Msk);
 310              		.loc 1 449 14
 311 0022 00BF     		nop
 312              	.L15:
 313              		.loc 1 449 25 discriminator 1
 314 0024 074B     		ldr	r3, .L16
 315 0026 9B69     		ldr	r3, [r3, #24]
 316              		.loc 1 449 35 discriminator 1
 317 0028 03F40003 		and	r3, r3, #8388608
 318              		.loc 1 449 14 discriminator 1
 319 002c 002B     		cmp	r3, #0
 320 002e F9D1     		bne	.L15
 321              	.L14:
 450:Drivers/Library/StdDriver/src/retarget.c ****     }
 451:Drivers/Library/StdDriver/src/retarget.c ****     DEBUG_PORT->DAT = ch;
 322              		.loc 1 451 15
ARM GAS  /tmp/cccbhmYm.s 			page 15


 323 0030 044A     		ldr	r2, .L16
 324              		.loc 1 451 21
 325 0032 7B68     		ldr	r3, [r7, #4]
 326 0034 1360     		str	r3, [r2]
 452:Drivers/Library/StdDriver/src/retarget.c **** }
 327              		.loc 1 452 1
 328 0036 00BF     		nop
 329 0038 0C37     		adds	r7, r7, #12
 330              	.LCFI13:
 331              		.cfi_def_cfa_offset 4
 332 003a BD46     		mov	sp, r7
 333              	.LCFI14:
 334              		.cfi_def_cfa_register 13
 335              		@ sp needed
 336 003c 5DF8047B 		ldr	r7, [sp], #4
 337              	.LCFI15:
 338              		.cfi_restore 7
 339              		.cfi_def_cfa_offset 0
 340 0040 7047     		bx	lr
 341              	.L17:
 342 0042 00BF     		.align	2
 343              	.L16:
 344 0044 00000740 		.word	1074200576
 345              		.cfi_endproc
 346              	.LFE198:
 348              		.section	.text.SendChar,"ax",%progbits
 349              		.align	1
 350              		.syntax unified
 351              		.thumb
 352              		.thumb_func
 353              		.fpu fpv4-sp-d16
 355              	SendChar:
 356              	.LFB199:
 453:Drivers/Library/StdDriver/src/retarget.c **** 
 454:Drivers/Library/StdDriver/src/retarget.c **** #else
 455:Drivers/Library/StdDriver/src/retarget.c **** /* Non-block implement of send char */
 456:Drivers/Library/StdDriver/src/retarget.c **** #define BUF_SIZE    2048
 457:Drivers/Library/StdDriver/src/retarget.c **** static void SendChar_ToUART(int ch)
 458:Drivers/Library/StdDriver/src/retarget.c **** {
 459:Drivers/Library/StdDriver/src/retarget.c ****     static uint8_t u8Buf[BUF_SIZE] = {0};
 460:Drivers/Library/StdDriver/src/retarget.c ****     static int32_t i32Head = 0;
 461:Drivers/Library/StdDriver/src/retarget.c ****     static int32_t i32Tail = 0;
 462:Drivers/Library/StdDriver/src/retarget.c ****     int32_t i32Tmp;
 463:Drivers/Library/StdDriver/src/retarget.c **** 
 464:Drivers/Library/StdDriver/src/retarget.c ****     /* Only flush the data in buffer to UART when ch == 0 */
 465:Drivers/Library/StdDriver/src/retarget.c ****     if(ch)
 466:Drivers/Library/StdDriver/src/retarget.c ****     {
 467:Drivers/Library/StdDriver/src/retarget.c ****         /* Push char */
 468:Drivers/Library/StdDriver/src/retarget.c ****         if(ch == '\n')
 469:Drivers/Library/StdDriver/src/retarget.c ****         {
 470:Drivers/Library/StdDriver/src/retarget.c ****             i32Tmp = i32Head+1;
 471:Drivers/Library/StdDriver/src/retarget.c ****             if(i32Tmp > BUF_SIZE) i32Tmp = 0;
 472:Drivers/Library/StdDriver/src/retarget.c ****             if(i32Tmp != i32Tail)
 473:Drivers/Library/StdDriver/src/retarget.c ****             {
 474:Drivers/Library/StdDriver/src/retarget.c ****                 u8Buf[i32Head] = '\r';
 475:Drivers/Library/StdDriver/src/retarget.c ****                 i32Head = i32Tmp;
 476:Drivers/Library/StdDriver/src/retarget.c ****             }
ARM GAS  /tmp/cccbhmYm.s 			page 16


 477:Drivers/Library/StdDriver/src/retarget.c ****         }
 478:Drivers/Library/StdDriver/src/retarget.c **** 
 479:Drivers/Library/StdDriver/src/retarget.c ****         i32Tmp = i32Head+1;
 480:Drivers/Library/StdDriver/src/retarget.c ****         if(i32Tmp > BUF_SIZE) i32Tmp = 0;
 481:Drivers/Library/StdDriver/src/retarget.c ****         if(i32Tmp != i32Tail)
 482:Drivers/Library/StdDriver/src/retarget.c ****         {
 483:Drivers/Library/StdDriver/src/retarget.c ****             u8Buf[i32Head] = ch;
 484:Drivers/Library/StdDriver/src/retarget.c ****             i32Head = i32Tmp;
 485:Drivers/Library/StdDriver/src/retarget.c ****         }
 486:Drivers/Library/StdDriver/src/retarget.c ****     }
 487:Drivers/Library/StdDriver/src/retarget.c ****     else
 488:Drivers/Library/StdDriver/src/retarget.c ****     {
 489:Drivers/Library/StdDriver/src/retarget.c ****         if(i32Tail == i32Head)
 490:Drivers/Library/StdDriver/src/retarget.c ****             return;
 491:Drivers/Library/StdDriver/src/retarget.c ****     }
 492:Drivers/Library/StdDriver/src/retarget.c **** 
 493:Drivers/Library/StdDriver/src/retarget.c ****     /* pop char */
 494:Drivers/Library/StdDriver/src/retarget.c ****     do
 495:Drivers/Library/StdDriver/src/retarget.c ****     {
 496:Drivers/Library/StdDriver/src/retarget.c ****         i32Tmp = i32Tail + 1;
 497:Drivers/Library/StdDriver/src/retarget.c ****         if(i32Tmp > BUF_SIZE) i32Tmp = 0;
 498:Drivers/Library/StdDriver/src/retarget.c **** 
 499:Drivers/Library/StdDriver/src/retarget.c ****         if((DEBUG_PORT->FIFOSTS & UART_FIFOSTS_TXFULL_Msk) == 0)
 500:Drivers/Library/StdDriver/src/retarget.c ****         {
 501:Drivers/Library/StdDriver/src/retarget.c ****             DEBUG_PORT->DAT = u8Buf[i32Tail];
 502:Drivers/Library/StdDriver/src/retarget.c ****             i32Tail = i32Tmp;
 503:Drivers/Library/StdDriver/src/retarget.c ****         }
 504:Drivers/Library/StdDriver/src/retarget.c ****         else
 505:Drivers/Library/StdDriver/src/retarget.c ****             break; /* FIFO full */
 506:Drivers/Library/StdDriver/src/retarget.c ****     }while(i32Tail != i32Head);
 507:Drivers/Library/StdDriver/src/retarget.c **** }
 508:Drivers/Library/StdDriver/src/retarget.c **** #endif   /* else for NONBLOCK_PRINTF */
 509:Drivers/Library/StdDriver/src/retarget.c **** 
 510:Drivers/Library/StdDriver/src/retarget.c **** #endif   /* if not def DISABLE_UART */
 511:Drivers/Library/StdDriver/src/retarget.c **** 
 512:Drivers/Library/StdDriver/src/retarget.c **** /**
 513:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       Routine to send a char
 514:Drivers/Library/StdDriver/src/retarget.c ****  *
 515:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]   ch Character to send to debug port.
 516:Drivers/Library/StdDriver/src/retarget.c ****  *
 517:Drivers/Library/StdDriver/src/retarget.c ****  * @returns     Send value from UART debug port or semihost
 518:Drivers/Library/StdDriver/src/retarget.c ****  *
 519:Drivers/Library/StdDriver/src/retarget.c ****  * @details     Send a target char to UART debug port or semihost.
 520:Drivers/Library/StdDriver/src/retarget.c ****  */
 521:Drivers/Library/StdDriver/src/retarget.c **** static void SendChar(int ch)
 522:Drivers/Library/StdDriver/src/retarget.c **** {
 357              		.loc 1 522 1
 358              		.cfi_startproc
 359              		@ args = 0, pretend = 0, frame = 8
 360              		@ frame_needed = 1, uses_anonymous_args = 0
 361 0000 80B5     		push	{r7, lr}
 362              	.LCFI16:
 363              		.cfi_def_cfa_offset 8
 364              		.cfi_offset 7, -8
 365              		.cfi_offset 14, -4
 366 0002 82B0     		sub	sp, sp, #8
 367              	.LCFI17:
ARM GAS  /tmp/cccbhmYm.s 			page 17


 368              		.cfi_def_cfa_offset 16
 369 0004 00AF     		add	r7, sp, #0
 370              	.LCFI18:
 371              		.cfi_def_cfa_register 7
 372 0006 7860     		str	r0, [r7, #4]
 523:Drivers/Library/StdDriver/src/retarget.c **** #if defined(DEBUG_ENABLE_SEMIHOST)
 524:Drivers/Library/StdDriver/src/retarget.c ****     g_buf[g_buf_len++] = ch;
 525:Drivers/Library/StdDriver/src/retarget.c ****     g_buf[g_buf_len] = '\0';
 526:Drivers/Library/StdDriver/src/retarget.c ****     if(g_buf_len + 1 >= sizeof(g_buf) || ch == '\n' || ch == '\0')
 527:Drivers/Library/StdDriver/src/retarget.c ****     {
 528:Drivers/Library/StdDriver/src/retarget.c ****         /* Send the char */
 529:Drivers/Library/StdDriver/src/retarget.c ****         if(SH_DoCommand(0x04, (int)g_buf, NULL) != 0)
 530:Drivers/Library/StdDriver/src/retarget.c ****         {
 531:Drivers/Library/StdDriver/src/retarget.c ****             g_buf_len = 0;
 532:Drivers/Library/StdDriver/src/retarget.c ****             return;
 533:Drivers/Library/StdDriver/src/retarget.c ****         }
 534:Drivers/Library/StdDriver/src/retarget.c ****         else
 535:Drivers/Library/StdDriver/src/retarget.c ****         {
 536:Drivers/Library/StdDriver/src/retarget.c **** #ifndef DISABLE_UART
 537:Drivers/Library/StdDriver/src/retarget.c ****             int i;
 538:Drivers/Library/StdDriver/src/retarget.c **** 
 539:Drivers/Library/StdDriver/src/retarget.c ****             for(i = 0; i < g_buf_len; i++)
 540:Drivers/Library/StdDriver/src/retarget.c ****                 SendChar_ToUART(g_buf[i]);
 541:Drivers/Library/StdDriver/src/retarget.c **** #endif
 542:Drivers/Library/StdDriver/src/retarget.c ****             g_buf_len = 0;
 543:Drivers/Library/StdDriver/src/retarget.c ****         }
 544:Drivers/Library/StdDriver/src/retarget.c ****     }
 545:Drivers/Library/StdDriver/src/retarget.c **** #else
 546:Drivers/Library/StdDriver/src/retarget.c **** #ifndef DISABLE_UART
 547:Drivers/Library/StdDriver/src/retarget.c ****     SendChar_ToUART(ch);
 373              		.loc 1 547 5
 374 0008 7868     		ldr	r0, [r7, #4]
 375 000a FFF7FEFF 		bl	SendChar_ToUART
 548:Drivers/Library/StdDriver/src/retarget.c **** #endif
 549:Drivers/Library/StdDriver/src/retarget.c **** #endif
 550:Drivers/Library/StdDriver/src/retarget.c **** }
 376              		.loc 1 550 1
 377 000e 00BF     		nop
 378 0010 0837     		adds	r7, r7, #8
 379              	.LCFI19:
 380              		.cfi_def_cfa_offset 8
 381 0012 BD46     		mov	sp, r7
 382              	.LCFI20:
 383              		.cfi_def_cfa_register 13
 384              		@ sp needed
 385 0014 80BD     		pop	{r7, pc}
 386              		.cfi_endproc
 387              	.LFE199:
 389              		.section	.text.GetChar,"ax",%progbits
 390              		.align	1
 391              		.syntax unified
 392              		.thumb
 393              		.thumb_func
 394              		.fpu fpv4-sp-d16
 396              	GetChar:
 397              	.LFB200:
 551:Drivers/Library/StdDriver/src/retarget.c **** 
ARM GAS  /tmp/cccbhmYm.s 			page 18


 552:Drivers/Library/StdDriver/src/retarget.c **** /**
 553:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    Routine to get a char
 554:Drivers/Library/StdDriver/src/retarget.c ****  *
 555:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 556:Drivers/Library/StdDriver/src/retarget.c ****  *
 557:Drivers/Library/StdDriver/src/retarget.c ****  * @returns  Get value from UART debug port or semihost
 558:Drivers/Library/StdDriver/src/retarget.c ****  *
 559:Drivers/Library/StdDriver/src/retarget.c ****  * @details  Wait UART debug port or semihost to input a char.
 560:Drivers/Library/StdDriver/src/retarget.c ****  */
 561:Drivers/Library/StdDriver/src/retarget.c **** static char GetChar(void)
 562:Drivers/Library/StdDriver/src/retarget.c **** {
 398              		.loc 1 562 1
 399              		.cfi_startproc
 400              		@ args = 0, pretend = 0, frame = 0
 401              		@ frame_needed = 1, uses_anonymous_args = 0
 402              		@ link register save eliminated.
 403 0000 80B4     		push	{r7}
 404              	.LCFI21:
 405              		.cfi_def_cfa_offset 4
 406              		.cfi_offset 7, -4
 407 0002 00AF     		add	r7, sp, #0
 408              	.LCFI22:
 409              		.cfi_def_cfa_register 7
 410              	.L22:
 563:Drivers/Library/StdDriver/src/retarget.c **** #ifdef DEBUG_ENABLE_SEMIHOST
 564:Drivers/Library/StdDriver/src/retarget.c **** # if defined (__CC_ARM)
 565:Drivers/Library/StdDriver/src/retarget.c ****     int nRet;
 566:Drivers/Library/StdDriver/src/retarget.c ****     while(SH_DoCommand(0x101, 0, &nRet) != 0)
 567:Drivers/Library/StdDriver/src/retarget.c ****     {
 568:Drivers/Library/StdDriver/src/retarget.c ****         if(nRet != 0)
 569:Drivers/Library/StdDriver/src/retarget.c ****         {
 570:Drivers/Library/StdDriver/src/retarget.c ****             SH_DoCommand(0x07, 0, &nRet);
 571:Drivers/Library/StdDriver/src/retarget.c ****             return (char)nRet;
 572:Drivers/Library/StdDriver/src/retarget.c ****         }
 573:Drivers/Library/StdDriver/src/retarget.c ****     }
 574:Drivers/Library/StdDriver/src/retarget.c **** # else
 575:Drivers/Library/StdDriver/src/retarget.c ****     int nRet;
 576:Drivers/Library/StdDriver/src/retarget.c ****     while(SH_DoCommand(0x7, 0, &nRet) != 0)
 577:Drivers/Library/StdDriver/src/retarget.c ****     {
 578:Drivers/Library/StdDriver/src/retarget.c ****         if(nRet != 0)
 579:Drivers/Library/StdDriver/src/retarget.c ****             return (char)nRet;
 580:Drivers/Library/StdDriver/src/retarget.c ****     }
 581:Drivers/Library/StdDriver/src/retarget.c **** # endif
 582:Drivers/Library/StdDriver/src/retarget.c ****     return (0);
 583:Drivers/Library/StdDriver/src/retarget.c **** #else
 584:Drivers/Library/StdDriver/src/retarget.c **** #ifndef DISABLE_UART
 585:Drivers/Library/StdDriver/src/retarget.c ****     while(1)
 586:Drivers/Library/StdDriver/src/retarget.c ****     {
 587:Drivers/Library/StdDriver/src/retarget.c ****         if((DEBUG_PORT->FIFOSTS & UART_FIFOSTS_RXEMPTY_Msk) == 0)
 411              		.loc 1 587 23
 412 0004 064B     		ldr	r3, .L24
 413 0006 9B69     		ldr	r3, [r3, #24]
 414              		.loc 1 587 33
 415 0008 03F48043 		and	r3, r3, #16384
 416              		.loc 1 587 11
 417 000c 002B     		cmp	r3, #0
 418 000e F9D1     		bne	.L22
ARM GAS  /tmp/cccbhmYm.s 			page 19


 588:Drivers/Library/StdDriver/src/retarget.c ****         {
 589:Drivers/Library/StdDriver/src/retarget.c ****             return (DEBUG_PORT->DAT);
 419              		.loc 1 589 31
 420 0010 034B     		ldr	r3, .L24
 421 0012 1B68     		ldr	r3, [r3]
 422 0014 5BB2     		sxtb	r3, r3
 590:Drivers/Library/StdDriver/src/retarget.c ****         }
 591:Drivers/Library/StdDriver/src/retarget.c ****     }
 592:Drivers/Library/StdDriver/src/retarget.c **** #else
 593:Drivers/Library/StdDriver/src/retarget.c ****     return 0;
 594:Drivers/Library/StdDriver/src/retarget.c **** #endif
 595:Drivers/Library/StdDriver/src/retarget.c **** #endif
 596:Drivers/Library/StdDriver/src/retarget.c **** }
 423              		.loc 1 596 1
 424 0016 1846     		mov	r0, r3
 425 0018 BD46     		mov	sp, r7
 426              	.LCFI23:
 427              		.cfi_def_cfa_register 13
 428              		@ sp needed
 429 001a 5DF8047B 		ldr	r7, [sp], #4
 430              	.LCFI24:
 431              		.cfi_restore 7
 432              		.cfi_def_cfa_offset 0
 433 001e 7047     		bx	lr
 434              	.L25:
 435              		.align	2
 436              	.L24:
 437 0020 00000740 		.word	1074200576
 438              		.cfi_endproc
 439              	.LFE200:
 441              		.section	.text.kbhit,"ax",%progbits
 442              		.align	1
 443              		.global	kbhit
 444              		.syntax unified
 445              		.thumb
 446              		.thumb_func
 447              		.fpu fpv4-sp-d16
 449              	kbhit:
 450              	.LFB201:
 597:Drivers/Library/StdDriver/src/retarget.c **** 
 598:Drivers/Library/StdDriver/src/retarget.c **** /**
 599:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    Check any char input from UART
 600:Drivers/Library/StdDriver/src/retarget.c ****  *
 601:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 602:Drivers/Library/StdDriver/src/retarget.c ****  *
 603:Drivers/Library/StdDriver/src/retarget.c ****  * @retval   1: No any char input
 604:Drivers/Library/StdDriver/src/retarget.c ****  * @retval   0: Have some char input
 605:Drivers/Library/StdDriver/src/retarget.c ****  *
 606:Drivers/Library/StdDriver/src/retarget.c ****  * @details  Check UART RSR RX EMPTY or not to determine if any char input from UART
 607:Drivers/Library/StdDriver/src/retarget.c ****  */
 608:Drivers/Library/StdDriver/src/retarget.c **** 
 609:Drivers/Library/StdDriver/src/retarget.c **** int kbhit(void)
 610:Drivers/Library/StdDriver/src/retarget.c **** {
 451              		.loc 1 610 1
 452              		.cfi_startproc
 453              		@ args = 0, pretend = 0, frame = 0
 454              		@ frame_needed = 1, uses_anonymous_args = 0
ARM GAS  /tmp/cccbhmYm.s 			page 20


 455              		@ link register save eliminated.
 456 0000 80B4     		push	{r7}
 457              	.LCFI25:
 458              		.cfi_def_cfa_offset 4
 459              		.cfi_offset 7, -4
 460 0002 00AF     		add	r7, sp, #0
 461              	.LCFI26:
 462              		.cfi_def_cfa_register 7
 611:Drivers/Library/StdDriver/src/retarget.c **** #ifndef DISABLE_UART
 612:Drivers/Library/StdDriver/src/retarget.c ****     return !((DEBUG_PORT->FIFOSTS & UART_FIFOSTS_RXEMPTY_Msk) == 0);
 463              		.loc 1 612 25
 464 0004 064B     		ldr	r3, .L28
 465 0006 9B69     		ldr	r3, [r3, #24]
 466              		.loc 1 612 35
 467 0008 03F48043 		and	r3, r3, #16384
 468              		.loc 1 612 12
 469 000c 002B     		cmp	r3, #0
 470 000e 14BF     		ite	ne
 471 0010 0123     		movne	r3, #1
 472 0012 0023     		moveq	r3, #0
 473 0014 DBB2     		uxtb	r3, r3
 613:Drivers/Library/StdDriver/src/retarget.c **** #else
 614:Drivers/Library/StdDriver/src/retarget.c ****     return 0;
 615:Drivers/Library/StdDriver/src/retarget.c **** #endif
 616:Drivers/Library/StdDriver/src/retarget.c **** }
 474              		.loc 1 616 1
 475 0016 1846     		mov	r0, r3
 476 0018 BD46     		mov	sp, r7
 477              	.LCFI27:
 478              		.cfi_def_cfa_register 13
 479              		@ sp needed
 480 001a 5DF8047B 		ldr	r7, [sp], #4
 481              	.LCFI28:
 482              		.cfi_restore 7
 483              		.cfi_def_cfa_offset 0
 484 001e 7047     		bx	lr
 485              	.L29:
 486              		.align	2
 487              	.L28:
 488 0020 00000740 		.word	1074200576
 489              		.cfi_endproc
 490              	.LFE201:
 492              		.section	.text.IsDebugFifoEmpty,"ax",%progbits
 493              		.align	1
 494              		.global	IsDebugFifoEmpty
 495              		.syntax unified
 496              		.thumb
 497              		.thumb_func
 498              		.fpu fpv4-sp-d16
 500              	IsDebugFifoEmpty:
 501              	.LFB202:
 617:Drivers/Library/StdDriver/src/retarget.c **** /**
 618:Drivers/Library/StdDriver/src/retarget.c ****  * @brief    Check if debug message finished
 619:Drivers/Library/StdDriver/src/retarget.c ****  *
 620:Drivers/Library/StdDriver/src/retarget.c ****  * @param    None
 621:Drivers/Library/StdDriver/src/retarget.c ****  *
 622:Drivers/Library/StdDriver/src/retarget.c ****  * @retval   1: Message is finished
ARM GAS  /tmp/cccbhmYm.s 			page 21


 623:Drivers/Library/StdDriver/src/retarget.c ****  * @retval   0: Message is transmitting.
 624:Drivers/Library/StdDriver/src/retarget.c ****  *
 625:Drivers/Library/StdDriver/src/retarget.c ****  * @details  Check if message finished (FIFO empty of debug port)
 626:Drivers/Library/StdDriver/src/retarget.c ****  */
 627:Drivers/Library/StdDriver/src/retarget.c **** 
 628:Drivers/Library/StdDriver/src/retarget.c **** int IsDebugFifoEmpty(void)
 629:Drivers/Library/StdDriver/src/retarget.c **** {
 502              		.loc 1 629 1
 503              		.cfi_startproc
 504              		@ args = 0, pretend = 0, frame = 0
 505              		@ frame_needed = 1, uses_anonymous_args = 0
 506              		@ link register save eliminated.
 507 0000 80B4     		push	{r7}
 508              	.LCFI29:
 509              		.cfi_def_cfa_offset 4
 510              		.cfi_offset 7, -4
 511 0002 00AF     		add	r7, sp, #0
 512              	.LCFI30:
 513              		.cfi_def_cfa_register 7
 630:Drivers/Library/StdDriver/src/retarget.c **** #ifndef DISABLE_UART
 631:Drivers/Library/StdDriver/src/retarget.c ****     return ((DEBUG_PORT->FIFOSTS & UART_FIFOSTS_TXEMPTYF_Msk) != 0);
 514              		.loc 1 631 24
 515 0004 064B     		ldr	r3, .L32
 516 0006 9B69     		ldr	r3, [r3, #24]
 517              		.loc 1 631 34
 518 0008 03F08053 		and	r3, r3, #268435456
 519              		.loc 1 631 63
 520 000c 002B     		cmp	r3, #0
 521 000e 14BF     		ite	ne
 522 0010 0123     		movne	r3, #1
 523 0012 0023     		moveq	r3, #0
 524 0014 DBB2     		uxtb	r3, r3
 632:Drivers/Library/StdDriver/src/retarget.c **** #else
 633:Drivers/Library/StdDriver/src/retarget.c ****     return 1;
 634:Drivers/Library/StdDriver/src/retarget.c **** #endif
 635:Drivers/Library/StdDriver/src/retarget.c **** }
 525              		.loc 1 635 1
 526 0016 1846     		mov	r0, r3
 527 0018 BD46     		mov	sp, r7
 528              	.LCFI31:
 529              		.cfi_def_cfa_register 13
 530              		@ sp needed
 531 001a 5DF8047B 		ldr	r7, [sp], #4
 532              	.LCFI32:
 533              		.cfi_restore 7
 534              		.cfi_def_cfa_offset 0
 535 001e 7047     		bx	lr
 536              	.L33:
 537              		.align	2
 538              	.L32:
 539 0020 00000740 		.word	1074200576
 540              		.cfi_endproc
 541              	.LFE202:
 543              		.section	.text._ttywrch,"ax",%progbits
 544              		.align	1
 545              		.global	_ttywrch
 546              		.syntax unified
ARM GAS  /tmp/cccbhmYm.s 			page 22


 547              		.thumb
 548              		.thumb_func
 549              		.fpu fpv4-sp-d16
 551              	_ttywrch:
 552              	.LFB203:
 636:Drivers/Library/StdDriver/src/retarget.c **** 
 637:Drivers/Library/StdDriver/src/retarget.c **** /**
 638:Drivers/Library/StdDriver/src/retarget.c ****  * @brief       C library retargetting
 639:Drivers/Library/StdDriver/src/retarget.c ****  *
 640:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]   ch Character to send to debug port.
 641:Drivers/Library/StdDriver/src/retarget.c ****  *
 642:Drivers/Library/StdDriver/src/retarget.c ****  * @returns     None
 643:Drivers/Library/StdDriver/src/retarget.c ****  *
 644:Drivers/Library/StdDriver/src/retarget.c ****  * @details     Check if message finished (FIFO empty of debug port)
 645:Drivers/Library/StdDriver/src/retarget.c ****  */
 646:Drivers/Library/StdDriver/src/retarget.c **** 
 647:Drivers/Library/StdDriver/src/retarget.c **** void _ttywrch(int ch)
 648:Drivers/Library/StdDriver/src/retarget.c **** {
 553              		.loc 1 648 1
 554              		.cfi_startproc
 555              		@ args = 0, pretend = 0, frame = 8
 556              		@ frame_needed = 1, uses_anonymous_args = 0
 557 0000 80B5     		push	{r7, lr}
 558              	.LCFI33:
 559              		.cfi_def_cfa_offset 8
 560              		.cfi_offset 7, -8
 561              		.cfi_offset 14, -4
 562 0002 82B0     		sub	sp, sp, #8
 563              	.LCFI34:
 564              		.cfi_def_cfa_offset 16
 565 0004 00AF     		add	r7, sp, #0
 566              	.LCFI35:
 567              		.cfi_def_cfa_register 7
 568 0006 7860     		str	r0, [r7, #4]
 649:Drivers/Library/StdDriver/src/retarget.c ****     SendChar(ch);
 569              		.loc 1 649 5
 570 0008 7868     		ldr	r0, [r7, #4]
 571 000a FFF7FEFF 		bl	SendChar
 650:Drivers/Library/StdDriver/src/retarget.c ****     return;
 572              		.loc 1 650 5
 573 000e 00BF     		nop
 651:Drivers/Library/StdDriver/src/retarget.c **** }
 574              		.loc 1 651 1
 575 0010 0837     		adds	r7, r7, #8
 576              	.LCFI36:
 577              		.cfi_def_cfa_offset 8
 578 0012 BD46     		mov	sp, r7
 579              	.LCFI37:
 580              		.cfi_def_cfa_register 13
 581              		@ sp needed
 582 0014 80BD     		pop	{r7, pc}
 583              		.cfi_endproc
 584              	.LFE203:
 586              		.section	.text.fputc,"ax",%progbits
 587              		.align	1
 588              		.global	fputc
 589              		.syntax unified
ARM GAS  /tmp/cccbhmYm.s 			page 23


 590              		.thumb
 591              		.thumb_func
 592              		.fpu fpv4-sp-d16
 594              	fputc:
 595              	.LFB204:
 652:Drivers/Library/StdDriver/src/retarget.c **** 
 653:Drivers/Library/StdDriver/src/retarget.c **** 
 654:Drivers/Library/StdDriver/src/retarget.c **** /**
 655:Drivers/Library/StdDriver/src/retarget.c ****  * @brief      Write character to stream
 656:Drivers/Library/StdDriver/src/retarget.c ****  *
 657:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]  ch       Character to be written. The character is passed as its int promotion.
 658:Drivers/Library/StdDriver/src/retarget.c ****  * @param[in]  stream   Pointer to a FILE object that identifies the stream where the character is 
 659:Drivers/Library/StdDriver/src/retarget.c ****  *
 660:Drivers/Library/StdDriver/src/retarget.c ****  * @returns    If there are no errors, the same character that has been written is returned.
 661:Drivers/Library/StdDriver/src/retarget.c ****  *             If an error occurs, EOF is returned and the error indicator is set (see ferror).
 662:Drivers/Library/StdDriver/src/retarget.c ****  *
 663:Drivers/Library/StdDriver/src/retarget.c ****  * @details    Writes a character to the stream and advances the position indicator.\n
 664:Drivers/Library/StdDriver/src/retarget.c ****  *             The character is written at the current position of the stream as indicated \n
 665:Drivers/Library/StdDriver/src/retarget.c ****  *             by the internal position indicator, which is then advanced one character.
 666:Drivers/Library/StdDriver/src/retarget.c ****  *
 667:Drivers/Library/StdDriver/src/retarget.c ****  * @note       The above descriptions are copied from http://www.cplusplus.com/reference/clibrary/c
 668:Drivers/Library/StdDriver/src/retarget.c ****  *
 669:Drivers/Library/StdDriver/src/retarget.c ****  *
 670:Drivers/Library/StdDriver/src/retarget.c ****  */
 671:Drivers/Library/StdDriver/src/retarget.c **** 
 672:Drivers/Library/StdDriver/src/retarget.c **** int fputc(int ch, FILE *stream)
 673:Drivers/Library/StdDriver/src/retarget.c **** {
 596              		.loc 1 673 1
 597              		.cfi_startproc
 598              		@ args = 0, pretend = 0, frame = 8
 599              		@ frame_needed = 1, uses_anonymous_args = 0
 600 0000 80B5     		push	{r7, lr}
 601              	.LCFI38:
 602              		.cfi_def_cfa_offset 8
 603              		.cfi_offset 7, -8
 604              		.cfi_offset 14, -4
 605 0002 82B0     		sub	sp, sp, #8
 606              	.LCFI39:
 607              		.cfi_def_cfa_offset 16
 608 0004 00AF     		add	r7, sp, #0
 609              	.LCFI40:
 610              		.cfi_def_cfa_register 7
 611 0006 7860     		str	r0, [r7, #4]
 612 0008 3960     		str	r1, [r7]
 674:Drivers/Library/StdDriver/src/retarget.c ****     SendChar(ch);
 613              		.loc 1 674 5
 614 000a 7868     		ldr	r0, [r7, #4]
 615 000c FFF7FEFF 		bl	SendChar
 675:Drivers/Library/StdDriver/src/retarget.c ****     return ch;
 616              		.loc 1 675 12
 617 0010 7B68     		ldr	r3, [r7, #4]
 676:Drivers/Library/StdDriver/src/retarget.c **** }
 618              		.loc 1 676 1
 619 0012 1846     		mov	r0, r3
 620 0014 0837     		adds	r7, r7, #8
 621              	.LCFI41:
 622              		.cfi_def_cfa_offset 8
ARM GAS  /tmp/cccbhmYm.s 			page 24


 623 0016 BD46     		mov	sp, r7
 624              	.LCFI42:
 625              		.cfi_def_cfa_register 13
 626              		@ sp needed
 627 0018 80BD     		pop	{r7, pc}
 628              		.cfi_endproc
 629              	.LFE204:
 631              		.section	.text._write,"ax",%progbits
 632              		.align	1
 633              		.global	_write
 634              		.syntax unified
 635              		.thumb
 636              		.thumb_func
 637              		.fpu fpv4-sp-d16
 639              	_write:
 640              	.LFB205:
 677:Drivers/Library/StdDriver/src/retarget.c **** 
 678:Drivers/Library/StdDriver/src/retarget.c **** #if defined (__GNUC__) && !defined(__ARMCC_VERSION)
 679:Drivers/Library/StdDriver/src/retarget.c **** 
 680:Drivers/Library/StdDriver/src/retarget.c **** int _write (int fd, char *ptr, int len)
 681:Drivers/Library/StdDriver/src/retarget.c **** {
 641              		.loc 1 681 1
 642              		.cfi_startproc
 643              		@ args = 0, pretend = 0, frame = 24
 644              		@ frame_needed = 1, uses_anonymous_args = 0
 645              		@ link register save eliminated.
 646 0000 80B4     		push	{r7}
 647              	.LCFI43:
 648              		.cfi_def_cfa_offset 4
 649              		.cfi_offset 7, -4
 650 0002 87B0     		sub	sp, sp, #28
 651              	.LCFI44:
 652              		.cfi_def_cfa_offset 32
 653 0004 00AF     		add	r7, sp, #0
 654              	.LCFI45:
 655              		.cfi_def_cfa_register 7
 656 0006 F860     		str	r0, [r7, #12]
 657 0008 B960     		str	r1, [r7, #8]
 658 000a 7A60     		str	r2, [r7, #4]
 682:Drivers/Library/StdDriver/src/retarget.c ****     int i = len;
 659              		.loc 1 682 9
 660 000c 7B68     		ldr	r3, [r7, #4]
 661 000e 7B61     		str	r3, [r7, #20]
 683:Drivers/Library/StdDriver/src/retarget.c **** 
 684:Drivers/Library/StdDriver/src/retarget.c ****     while(i--)
 662              		.loc 1 684 10
 663 0010 1CE0     		b	.L39
 664              	.L43:
 685:Drivers/Library/StdDriver/src/retarget.c ****     {
 686:Drivers/Library/StdDriver/src/retarget.c ****         while(DEBUG_PORT->FIFOSTS & UART_FIFOSTS_TXFULL_Msk);
 665              		.loc 1 686 14
 666 0012 00BF     		nop
 667              	.L40:
 668              		.loc 1 686 25 discriminator 1
 669 0014 134B     		ldr	r3, .L45
 670 0016 9B69     		ldr	r3, [r3, #24]
 671              		.loc 1 686 35 discriminator 1
ARM GAS  /tmp/cccbhmYm.s 			page 25


 672 0018 03F40003 		and	r3, r3, #8388608
 673              		.loc 1 686 14 discriminator 1
 674 001c 002B     		cmp	r3, #0
 675 001e F9D1     		bne	.L40
 687:Drivers/Library/StdDriver/src/retarget.c **** 
 688:Drivers/Library/StdDriver/src/retarget.c ****         if(*ptr == '\n')
 676              		.loc 1 688 12
 677 0020 BB68     		ldr	r3, [r7, #8]
 678 0022 93F90030 		ldrsb	r3, [r3]
 679              		.loc 1 688 11
 680 0026 0A2B     		cmp	r3, #10
 681 0028 09D1     		bne	.L41
 689:Drivers/Library/StdDriver/src/retarget.c ****         {
 690:Drivers/Library/StdDriver/src/retarget.c ****             DEBUG_PORT->DAT = '\r';
 682              		.loc 1 690 23
 683 002a 0E4B     		ldr	r3, .L45
 684              		.loc 1 690 29
 685 002c 0D22     		movs	r2, #13
 686 002e 1A60     		str	r2, [r3]
 691:Drivers/Library/StdDriver/src/retarget.c ****             while(DEBUG_PORT->FIFOSTS & UART_FIFOSTS_TXFULL_Msk);
 687              		.loc 1 691 18
 688 0030 00BF     		nop
 689              	.L42:
 690              		.loc 1 691 29 discriminator 1
 691 0032 0C4B     		ldr	r3, .L45
 692 0034 9B69     		ldr	r3, [r3, #24]
 693              		.loc 1 691 39 discriminator 1
 694 0036 03F40003 		and	r3, r3, #8388608
 695              		.loc 1 691 18 discriminator 1
 696 003a 002B     		cmp	r3, #0
 697 003c F9D1     		bne	.L42
 698              	.L41:
 692:Drivers/Library/StdDriver/src/retarget.c ****         }
 693:Drivers/Library/StdDriver/src/retarget.c **** 
 694:Drivers/Library/StdDriver/src/retarget.c ****         DEBUG_PORT->DAT = *ptr++;
 699              		.loc 1 694 31
 700 003e BB68     		ldr	r3, [r7, #8]
 701 0040 5A1C     		adds	r2, r3, #1
 702 0042 BA60     		str	r2, [r7, #8]
 703              		.loc 1 694 27
 704 0044 93F90020 		ldrsb	r2, [r3]
 705              		.loc 1 694 19
 706 0048 064B     		ldr	r3, .L45
 707              		.loc 1 694 25
 708 004a 1A60     		str	r2, [r3]
 709              	.L39:
 684:Drivers/Library/StdDriver/src/retarget.c ****     {
 710              		.loc 1 684 12
 711 004c 7B69     		ldr	r3, [r7, #20]
 712 004e 5A1E     		subs	r2, r3, #1
 713 0050 7A61     		str	r2, [r7, #20]
 684:Drivers/Library/StdDriver/src/retarget.c ****     {
 714              		.loc 1 684 10
 715 0052 002B     		cmp	r3, #0
 716 0054 DDD1     		bne	.L43
 695:Drivers/Library/StdDriver/src/retarget.c **** 
 696:Drivers/Library/StdDriver/src/retarget.c ****     }
ARM GAS  /tmp/cccbhmYm.s 			page 26


 697:Drivers/Library/StdDriver/src/retarget.c ****     return len;
 717              		.loc 1 697 12
 718 0056 7B68     		ldr	r3, [r7, #4]
 698:Drivers/Library/StdDriver/src/retarget.c **** }
 719              		.loc 1 698 1
 720 0058 1846     		mov	r0, r3
 721 005a 1C37     		adds	r7, r7, #28
 722              	.LCFI46:
 723              		.cfi_def_cfa_offset 4
 724 005c BD46     		mov	sp, r7
 725              	.LCFI47:
 726              		.cfi_def_cfa_register 13
 727              		@ sp needed
 728 005e 5DF8047B 		ldr	r7, [sp], #4
 729              	.LCFI48:
 730              		.cfi_restore 7
 731              		.cfi_def_cfa_offset 0
 732 0062 7047     		bx	lr
 733              	.L46:
 734              		.align	2
 735              	.L45:
 736 0064 00000740 		.word	1074200576
 737              		.cfi_endproc
 738              	.LFE205:
 740              		.section	.text._read,"ax",%progbits
 741              		.align	1
 742              		.global	_read
 743              		.syntax unified
 744              		.thumb
 745              		.thumb_func
 746              		.fpu fpv4-sp-d16
 748              	_read:
 749              	.LFB206:
 699:Drivers/Library/StdDriver/src/retarget.c **** 
 700:Drivers/Library/StdDriver/src/retarget.c **** int _read (int fd, char *ptr, int len)
 701:Drivers/Library/StdDriver/src/retarget.c **** {
 750              		.loc 1 701 1
 751              		.cfi_startproc
 752              		@ args = 0, pretend = 0, frame = 16
 753              		@ frame_needed = 1, uses_anonymous_args = 0
 754              		@ link register save eliminated.
 755 0000 80B4     		push	{r7}
 756              	.LCFI49:
 757              		.cfi_def_cfa_offset 4
 758              		.cfi_offset 7, -4
 759 0002 85B0     		sub	sp, sp, #20
 760              	.LCFI50:
 761              		.cfi_def_cfa_offset 24
 762 0004 00AF     		add	r7, sp, #0
 763              	.LCFI51:
 764              		.cfi_def_cfa_register 7
 765 0006 F860     		str	r0, [r7, #12]
 766 0008 B960     		str	r1, [r7, #8]
 767 000a 7A60     		str	r2, [r7, #4]
 702:Drivers/Library/StdDriver/src/retarget.c **** 
 703:Drivers/Library/StdDriver/src/retarget.c ****     while((DEBUG_PORT->FIFOSTS & UART_FIFOSTS_RXEMPTY_Msk) != 0);
 768              		.loc 1 703 10
ARM GAS  /tmp/cccbhmYm.s 			page 27


 769 000c 00BF     		nop
 770              	.L48:
 771              		.loc 1 703 22 discriminator 1
 772 000e 094B     		ldr	r3, .L50
 773 0010 9B69     		ldr	r3, [r3, #24]
 774              		.loc 1 703 32 discriminator 1
 775 0012 03F48043 		and	r3, r3, #16384
 776              		.loc 1 703 10 discriminator 1
 777 0016 002B     		cmp	r3, #0
 778 0018 F9D1     		bne	.L48
 704:Drivers/Library/StdDriver/src/retarget.c ****     *ptr = DEBUG_PORT->DAT;
 779              		.loc 1 704 22
 780 001a 064B     		ldr	r3, .L50
 781 001c 1B68     		ldr	r3, [r3]
 782              		.loc 1 704 10
 783 001e 5AB2     		sxtb	r2, r3
 784 0020 BB68     		ldr	r3, [r7, #8]
 785 0022 1A70     		strb	r2, [r3]
 705:Drivers/Library/StdDriver/src/retarget.c ****     return 1;
 786              		.loc 1 705 12
 787 0024 0123     		movs	r3, #1
 706:Drivers/Library/StdDriver/src/retarget.c **** 
 707:Drivers/Library/StdDriver/src/retarget.c **** 
 708:Drivers/Library/StdDriver/src/retarget.c **** }
 788              		.loc 1 708 1
 789 0026 1846     		mov	r0, r3
 790 0028 1437     		adds	r7, r7, #20
 791              	.LCFI52:
 792              		.cfi_def_cfa_offset 4
 793 002a BD46     		mov	sp, r7
 794              	.LCFI53:
 795              		.cfi_def_cfa_register 13
 796              		@ sp needed
 797 002c 5DF8047B 		ldr	r7, [sp], #4
 798              	.LCFI54:
 799              		.cfi_restore 7
 800              		.cfi_def_cfa_offset 0
 801 0030 7047     		bx	lr
 802              	.L51:
 803 0032 00BF     		.align	2
 804              	.L50:
 805 0034 00000740 		.word	1074200576
 806              		.cfi_endproc
 807              	.LFE206:
 809              		.text
 810              	.Letext0:
 811              		.file 2 "/usr/include/newlib/machine/_default_types.h"
 812              		.file 3 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stddef.h"
 813              		.file 4 "/usr/include/newlib/sys/_types.h"
 814              		.file 5 "/usr/include/newlib/sys/reent.h"
 815              		.file 6 "/usr/include/newlib/sys/lock.h"
 816              		.file 7 "/usr/include/newlib/sys/_stdint.h"
 817              		.file 8 "/usr/include/newlib/stdio.h"
 818              		.file 9 "Drivers/Library/Device/Nuvoton_M480/Include/uart_reg.h"
ARM GAS  /tmp/cccbhmYm.s 			page 28


DEFINED SYMBOLS
                            *ABS*:0000000000000000 retarget.c
     /tmp/cccbhmYm.s:22     .bss.__stdout:0000000000000000 __stdout
     /tmp/cccbhmYm.s:19     .bss.__stdout:0000000000000000 $d
     /tmp/cccbhmYm.s:29     .bss.__stdin:0000000000000000 __stdin
     /tmp/cccbhmYm.s:26     .bss.__stdin:0000000000000000 $d
     /tmp/cccbhmYm.s:32     .rodata:0000000000000000 $d
     /tmp/cccbhmYm.s:57     .text.stackDump:0000000000000000 $t
     /tmp/cccbhmYm.s:64     .text.stackDump:0000000000000000 stackDump
     /tmp/cccbhmYm.s:158    .text.stackDump:0000000000000080 $d
     /tmp/cccbhmYm.s:174    .text.Hard_Fault_Handler:0000000000000000 $t
     /tmp/cccbhmYm.s:181    .text.Hard_Fault_Handler:0000000000000000 Hard_Fault_Handler
     /tmp/cccbhmYm.s:211    .text.Hard_Fault_Handler:0000000000000018 $d
     /tmp/cccbhmYm.s:216    .text.HardFault_Handler:0000000000000000 $t
     /tmp/cccbhmYm.s:223    .text.HardFault_Handler:0000000000000000 HardFault_Handler
     /tmp/cccbhmYm.s:261    .text.HardFault_Handler:0000000000000024 $d
     /tmp/cccbhmYm.s:266    .text.SendChar_ToUART:0000000000000000 $t
     /tmp/cccbhmYm.s:272    .text.SendChar_ToUART:0000000000000000 SendChar_ToUART
     /tmp/cccbhmYm.s:344    .text.SendChar_ToUART:0000000000000044 $d
     /tmp/cccbhmYm.s:349    .text.SendChar:0000000000000000 $t
     /tmp/cccbhmYm.s:355    .text.SendChar:0000000000000000 SendChar
     /tmp/cccbhmYm.s:390    .text.GetChar:0000000000000000 $t
     /tmp/cccbhmYm.s:396    .text.GetChar:0000000000000000 GetChar
     /tmp/cccbhmYm.s:437    .text.GetChar:0000000000000020 $d
     /tmp/cccbhmYm.s:442    .text.kbhit:0000000000000000 $t
     /tmp/cccbhmYm.s:449    .text.kbhit:0000000000000000 kbhit
     /tmp/cccbhmYm.s:488    .text.kbhit:0000000000000020 $d
     /tmp/cccbhmYm.s:493    .text.IsDebugFifoEmpty:0000000000000000 $t
     /tmp/cccbhmYm.s:500    .text.IsDebugFifoEmpty:0000000000000000 IsDebugFifoEmpty
     /tmp/cccbhmYm.s:539    .text.IsDebugFifoEmpty:0000000000000020 $d
     /tmp/cccbhmYm.s:544    .text._ttywrch:0000000000000000 $t
     /tmp/cccbhmYm.s:551    .text._ttywrch:0000000000000000 _ttywrch
     /tmp/cccbhmYm.s:587    .text.fputc:0000000000000000 $t
     /tmp/cccbhmYm.s:594    .text.fputc:0000000000000000 fputc
     /tmp/cccbhmYm.s:632    .text._write:0000000000000000 $t
     /tmp/cccbhmYm.s:639    .text._write:0000000000000000 _write
     /tmp/cccbhmYm.s:736    .text._write:0000000000000064 $d
     /tmp/cccbhmYm.s:741    .text._read:0000000000000000 $t
     /tmp/cccbhmYm.s:748    .text._read:0000000000000000 _read
     /tmp/cccbhmYm.s:805    .text._read:0000000000000034 $d

UNDEFINED SYMBOLS
printf
puts
